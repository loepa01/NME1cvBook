
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Interpolace a aproximace funkcí &#8212; NME1cvBook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lekce/05-aproximace-funkci';</script>
    <link rel="icon" href="../_static/cphys2.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Řešení nelineárních rovnic" href="07-nelinearni-rce.html" />
    <link rel="prev" title="Iterační metody lineární algebry" href="../lekce-vyplnene/04-linalg-iter-vypl.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/cphys-logo6.png" class="logo__image only-light" alt="NME1cvBook - Home"/>
    <script>document.write(`<img src="../_static/cphys-logo6.png" class="logo__image only-dark" alt="NME1cvBook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Numerické metody (NME1cv) - cvičení 2025
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Obsah cvičení</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../lekce-vyplnene/01-uvod-python-vypl.html">1. Úvod do jazyka Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lekce-vyplnene/02-chyby-stabilita-vypl.html">2. Numerické chyby a stabilita</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lekce-vyplnene/03-linalg-prime-vypl.html">3. Metody lineární algebry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lekce-vyplnene/04-linalg-iter-vypl.html">4. Iterační metody lineární algebry</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Interpolace a aproximace funkcí</a></li>
<li class="toctree-l1"><a class="reference internal" href="07-nelinearni-rce.html">7. Nelineární rovnice</a></li>
<li class="toctree-l1"><a class="reference internal" href="08-extremy-fci.html">8. Extrémy funkcí</a></li>
<li class="toctree-l1"><a class="reference internal" href="09-integrace.html">9. Numerická integrace</a></li>
<li class="toctree-l1"><a class="reference internal" href="10-reseni-odr.html">10. Obyčejné diferenciální rovnice</a></li>
<li class="toctree-l1"><a class="reference internal" href="11-reseni-okraj.html">11. Diferenciální rovnice s okrajovou podmínkou</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Úkoly</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ukoly/02-chyby-stabilita-UKOL.html">2. Numerické chyby a stabilita</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/03-linalg-prime-UKOL.html">3. Metody lineární algebry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/04-linalg-iter-UKOL.html">4. Iterační metody lineární algebry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/05-aproximace-funkci-UKOL.html">5. Interpolace a aproximace funkcí</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/07-nelinearni-rce-UKOL.html">7. Nelineární rovnice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/08-extremy-fci-UKOL.html">8. Extrémy funkcí</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/09-integrace-UKOL.html">9. Numerická integrace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/10-reseni-odr-UKOL.html">10. Obyčejné diferenciální rovnice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/11-reseni-okraj-UKOL.html">11. Diferenciální rovnice s okrajovou podmínkou</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/loepa01/NME1cvBook/main?urlpath=lab/tree/lekce/05-aproximace-funkci.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://jupyter.fjfi.cvut.cz/hub/user-redirect/git-pull?repo=https%3A//github.com/loepa01/NME1cvBook&urlpath=lab/tree/NME1cvBook/lekce/05-aproximace-funkci.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/loepa01/NME1cvBook/blob/main/lekce/05-aproximace-funkci.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/loepa01/NME1cvBook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/loepa01/NME1cvBook/issues/new?title=Issue%20on%20page%20%2Flekce/05-aproximace-funkci.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lekce/05-aproximace-funkci.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Interpolace a aproximace funkcí</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lokalni-interpolace">Lokální interpolace</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linearni-interpolace">Lineární interpolace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolacni-spline">Interpolační spline</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#globalni-interpolace">Globální interpolace</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lagrangeova-interpolace">Lagrangeova interpolace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nevilluv-algoritmus">Nevillův algoritmus</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rungeho-jev">Rungeho jev</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cebysevova-interpolace">Čebyševova interpolace</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelovani-dat">Modelování dat</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metoda-nejmensich-ctvercu">Metoda nejmenších čtverců</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="interpolace-a-aproximace-funkci">
<h1>Interpolace a aproximace funkcí<a class="headerlink" href="#interpolace-a-aproximace-funkci" title="Link to this heading">#</a></h1>
<p>V této kapitole si představíme problém aproximace a interpolace funkcí. Touto kapitolou začíná část kurzu numeriky, zabývající se funkčními závislostmi a problémy z matematické analýzy.</p>
<p>Problém, nazvaný <em>interpolace</em>, vychází z následující situace. Uvažujme funkci <span class="math notranslate nohighlight">\(f(x)\)</span>, pro kterou nemáme žádný analytický předpis, pouze známe hodnotu funkce na jisté množině bodů <span class="math notranslate nohighlight">\(x_0, x_1, \dots, x_{N-1}\)</span> (<span class="math notranslate nohighlight">\(x_0 \lt x_1 \lt \dots \lt x_{N-1}\)</span>). Tyto hodnoty můžou být získany například experimentálně nebo nějakým (náročným) výpočtem. Funkce <span class="math notranslate nohighlight">\(f(x)\)</span> pak může být potřeba k dalším výpočtům a typicky je nutné vyhodnocovat tuto funkci nejen v bodech <span class="math notranslate nohighlight">\(x_i\)</span>, ale pro libovolné <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Cílem <strong>interpolace</strong> je získat odhad funkční závislosti funkce <span class="math notranslate nohighlight">\(f(x)\)</span> mezi body <span class="math notranslate nohighlight">\(x_i\)</span>. Naopak <strong>extrapolace</strong> aproximuje funkci mimo interval <span class="math notranslate nohighlight">\([x_0, x_{N-1}]\)</span>. Extrapolace je výrazně komplikovanější problém, proto se v této kapitole zaměříme pouze na interpolaci funkcí.</p>
<p>Aproximace funkcí jsou také užitečné pro další analýzu funkcí, jako například výpočet extrémů, derivací nebo integrálu.</p>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #276BE9; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #DCE7FC; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Poznámka</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Interpolace souvisí s aproximací funkcí, ale není to samé. U interpolace máme funkci zadanou v určitých bodech, které si nevybíráme. Neznáme analytický předpis a nemůžeme tedy funkci vyhodnotit v jiných bodech.</p>
<p>Naopak <strong>aproximace funkce</strong> spočívá ve zjednodušení a v urychlení vyhodnocení funkce <span class="math notranslate nohighlight">\(f(x)\)</span> v bodě <span class="math notranslate nohighlight">\(x\)</span>. V takové situaci máme analytický předpis nebo dokážeme funkční hodnotu spočítat v libovolném bodě, ale výpočet chceme urychlit.</p>
</p>
</div>
</div><p>Důležitou součástí interpolačních metod, jako všude v numerice, je odhad chyby. Při interpolaci se vždy budeme dopouštět chyby metody, jelikož nedokážeme aproximovat funkce s libovolnou přesností na spojitém intervalu. Interpolační metody vždy předpokládají jistý stupeň hladkosti odhadované funkce. Nespojité a jiné  nepěkné funkce jsou pro interpolaci kompilací a chyba zde bude poměrně vysoká.</p>
<p>Ukážeme si následující typy aproximačních metod:</p>
<p><strong>Typy interpolačních metod</strong></p>
<ol class="arabic simple">
<li><p>Lokální interpolace</p></li>
<li><p>Spliny (<em>lokální</em>/<em>částečně nelokální</em>)</p></li>
<li><p>Polynomiální interpolace (<em>globální</em>) - Lagrangeovy a Newtonovy polynomy</p></li>
</ol>
<p><strong>Další aproximační metody</strong></p>
<ol class="arabic simple" start="3">
<li><p>Čebyševovy polynomy - “nejlepší stejnoměrná aproximace”</p></li>
<li><p>Fitování funkcí - metoda nejmenších čtverců</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span><span class="p">,</span> <span class="n">interpolate</span><span class="p">,</span> <span class="n">special</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<section id="lokalni-interpolace">
<h2>Lokální interpolace<a class="headerlink" href="#lokalni-interpolace" title="Link to this heading">#</a></h2>
<p>Interpolace je sestavena po částech, podintervalech, na kterých je funkce aproximována zvlášť, nezávisle na ostatních bodech. V každém podintervalu je použita jiná interpolační funkce.</p>
<section id="linearni-interpolace">
<h3>Lineární interpolace<a class="headerlink" href="#linearni-interpolace" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Linear_interpolation">Lineární interpolace</a> je definována jako spojení úseček spojujících dvojici bodů z množiny bodů, ve kterých známe danou funkci. Uvažujme dvojici bodů <span class="math notranslate nohighlight">\( (x_{i}, y_{i}) \)</span> a <span class="math notranslate nohighlight">\( (x_{i + 1}, y_{i + 1}) \)</span>, pak lokální lineární interpolace na intervalu <span class="math notranslate nohighlight">\( (x_{i}, x_{i + 1}) \)</span> je dána následujícím vztahem:</p>
<div class="math notranslate nohighlight">
\[
y = y_i + \alpha (x - x_i), \qquad x \in [x_i, x_{i+1}],
\]</div>
<p>kde</p>
<div class="math notranslate nohighlight">
\[
\alpha = \frac{y_{i+1} - y_{i}}{x_{i + 1} - x_{i}}
\]</div>
<p>je sklon úsečky.</p>
<p>Ukázka lineární interpolace na funkci <span class="math notranslate nohighlight">\(\cos(x)\)</span>. V praxi často funkci neznáme analyticky, zde využíváme známou funkci pro lepší představu. Zde pouze vykreslíme funkci na několika málo bodech a tím získáme <em>iluzi</em> interpolace.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="c1"># presna funkce</span>
<span class="n">xint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="c1"># linearni interpolace</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cos(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">xint</span><span class="p">),</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interpolace&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d602e7cdc98c3a9f8be1d8e7aeee6f0c3db0527e63286b5810e318400ceda6c1.png" src="../_images/d602e7cdc98c3a9f8be1d8e7aeee6f0c3db0527e63286b5810e318400ceda6c1.png" />
</div>
</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Doplňte následující funkci <code class="docutils literal notranslate"><span class="pre">linearni_interpolace()</span></code>, která pro zadanou množinu dat <code class="docutils literal notranslate"><span class="pre">x_p,</span> <span class="pre">y_p</span></code> spočítá lineární interpolaci. Bude tedy možné vyhodnotit funkci, aproximovanou hodnotami <code class="docutils literal notranslate"><span class="pre">x_p,</span> <span class="pre">y_p</span></code>, v libovolném bodě <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>Uvažujte již setřízené hodnoty v poli <code class="docutils literal notranslate"><span class="pre">x_p</span></code>.</p>
</p>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">linearni_interpolace</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="c1">## DOPLŇTE ##</span>
    
<span class="c1"># vykresleni</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">xint</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">linearni_interpolace</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">xi</span><span class="p">)</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cos(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;lin. interpolace&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cbc5e5982f492b1d2b4a5ba2f9cd5822554d7b82c85889702c7082b782f8c4d4.png" src="../_images/cbc5e5982f492b1d2b4a5ba2f9cd5822554d7b82c85889702c7082b782f8c4d4.png" />
</div>
</div>
<p>Lineární interpolace zajištuje knihovní funkce <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.interp1d()</span></code>.</p>
</section>
<section id="interpolacni-spline">
<h3>Interpolační spline<a class="headerlink" href="#interpolacni-spline" title="Link to this heading">#</a></h3>
<p>Oproti lineární interpolaci, <a class="reference external" href="https://en.wikipedia.org/wiki/Spline_interpolation">interpolační spliny</a> mají navíc spojitou první a vyšší derivace. Interpolace probíhá lokálně na podintervalech, na kterých je funkce aproximována polynomem. Na hranicích podintervalů, tedy ve známých bodech, jsou kladeny podmínky spojitosti a spojitosti derivací.</p>
<p>Pokud vyžadujeme spojitost derivací do 1. řádu, potřebujeme minimálně polynom se čtyřmi volnými parametry - <strong>kubický spline</strong>. Konstrukci si můžete zopakovat <a class="reference external" href="http://pascal.fjfi.cvut.cz/~vachal/edu/nme/cviceni/03_aprox/DOCS/teorie_kubicky_spline.pdf">zde</a>.</p>
<p><strong>Vlastnosti</strong>:</p>
<ul class="simple">
<li><p>Stabilnější oproti polynomiální aproximaci</p></li>
<li><p>Méně podléhají oscilacím mezi známými body (Rungeho jev)</p></li>
</ul>
</section>
</section>
<section id="globalni-interpolace">
<h2>Globální interpolace<a class="headerlink" href="#globalni-interpolace" title="Link to this heading">#</a></h2>
<p>V globální interpolaci je ve všech podintervalech využita jedna stejná funkce.</p>
<section id="lagrangeova-interpolace">
<h3>Lagrangeova interpolace<a class="headerlink" href="#lagrangeova-interpolace" title="Link to this heading">#</a></h3>
<p>Lagrangeova interpolace využívá k aproximaci funkce sadu Lagrangeových polynomů. Pro <span class="math notranslate nohighlight">\( n \)</span> známých bodů <span class="math notranslate nohighlight">\( (x_{i}, y_{i}) \)</span>, <span class="math notranslate nohighlight">\( i = 0, 1, \dots, n-1 \)</span>, kde žádné dva <span class="math notranslate nohighlight">\( x_i \)</span> jsou stejné, <a class="reference external" href="https://en.wikipedia.org/wiki/Lagrange_polynomial">Lagrangeova interpolace</a> je polynom <span class="math notranslate nohighlight">\( (n-1) \)</span>-tého stupně, daný lineární kombinací:</p>
<div class="math notranslate nohighlight">
\[
L(x) = \sum_{i = 0}^{n-1} y_i \Gamma_i(x)
\]</div>
<p>bází Lagrangeových polynomů a kde</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Gamma_i(x) = \prod_{\substack{j = 0 \\ j \neq i}}^{n-1} \frac{x - x_j}{x_i - x_j}
\end{split}\]</div>
<p>jsou tzv. pomocné funkce, pro které platí:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Gamma_i(x_j) = \begin{cases}
            1, &amp; i = j,\\
            0, &amp; i \neq j.
         \end{cases}
\end{split}\]</div>
<p>Výsledný Lagrangeův interpolační polynom je jednoznačný.</p>
<p><img alt="Lagrangeův polynom ukázka" src="../_images/lagrange.png" /></p>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Doplňte následující funkci <code class="docutils literal notranslate"><span class="pre">lagrangeova_interpolace()</span></code>, která pro zadanou množinu dat <code class="docutils literal notranslate"><span class="pre">x_p,</span> <span class="pre">y_p</span></code> spočítá interpolaci pomocí Lagrangeových polynomů.</p>
<p>Využijte k implementaci struktury <code class="docutils literal notranslate"><span class="pre">np.poly1d</span></code> (speciální pole koeficientů polynomu, operace s polynomy), která výrazně zjednodušuje práci s polynomy. Funkce by měla vracet polynom v tomto tvaru.</p>
</p>
</div>
</div><p>Ukázka práce s <code class="docutils literal notranslate"><span class="pre">np.poly1d</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># 2x + 1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="c1"># (2x + 1) + 5*(2x + 1)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># (2x + 1)^2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span> <span class="c1"># (2x + 1) * 4x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
12 x + 6
   2
4 x + 4 x + 1
   2
8 x + 4 x
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lagrangeova_interpolace</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">):</span>
    <span class="c1">## DOPLŇTE ##</span>

<span class="n">x_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">y_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_p</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x_p</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">lag</span> <span class="o">=</span> <span class="n">lagrangeova_interpolace</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lag</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        4         3         2
-23.33 x + 41.15 x - 22.35 x + 3.289 x + 0.763
</pre></div>
</div>
<img alt="../_images/7b8831916136584fc52ab977f4164120fee93f8f365179fbe95ae9b4389abb4a.png" src="../_images/7b8831916136584fc52ab977f4164120fee93f8f365179fbe95ae9b4389abb4a.png" />
</div>
</div>
<p>Použití Lagrangeovy interpolace na funkci <span class="math notranslate nohighlight">\(\cos(x)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">y_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_p</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x_p</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">lag</span> <span class="o">=</span> <span class="n">lagrangeova_interpolace</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lag</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;lagrange. interp.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cos(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           14             13             12             11
4.633e-25 x  - 6.826e-11 x  + 6.969e-09 x  - 3.088e-07 x 
              10             9            8            7           6
 + 7.759e-06 x  - 0.0001216 x + 0.001237 x - 0.008369 x + 0.03924 x
           5          4          3          2
 - 0.1377 x + 0.3583 x - 0.4653 x - 0.1119 x - 0.1367 x + 1
</pre></div>
</div>
<img alt="../_images/b584f4f23086beba44a3bbc0e1fef7a4dfd6554b7022944e1e130725db7129a7.png" src="../_images/b584f4f23086beba44a3bbc0e1fef7a4dfd6554b7022944e1e130725db7129a7.png" />
</div>
</div>
<p>Správnost implementace můžeme ověřit pomocí odpovídající knihovní funkce <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.lagrange.html"><code class="docutils literal notranslate"><span class="pre">scipy.interpolate.lagrange()</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">lagrangeova_interpolace</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">),</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">lagrange</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">),</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">E</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The implementation is correct.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The implementation is correct.
</pre></div>
</div>
</div>
</div>
</section>
<section id="nevilluv-algoritmus">
<h3>Nevillův algoritmus<a class="headerlink" href="#nevilluv-algoritmus" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Neville%27s_algorithm">Nevillův algoritmus</a> je alternativní rekurzivní postup pro výpočet Lagrangeova interpolačního polynomu. Je dán následujícím vztahem:</p>
<div class="math notranslate nohighlight">
\[
L_{i, j} = \frac{(x - x_j) L_{i, j-1} - (x - x_i) L_{i+1, j}}{x_i - x_j}, \qquad L_{i, i} = y_i, \qquad i, j = 0, 1, \dots, n-1.
\]</div>
<p>Lagrangeoův interpolační polynom je pak <span class="math notranslate nohighlight">\( L(x) = L_{0, n-1} \)</span>.</p>
<p>Výhodnou tohoto algoritmu je možnost postupného zpřesňování aproximace (<strong>“iterovaná interpolace”</strong>) přidáváním nových bodů. Také lze snadno odhadnout chybu aproximace rozdílem za sebou jdoucích interpolací řádu <span class="math notranslate nohighlight">\(n\)</span> a <span class="math notranslate nohighlight">\(n-1\)</span>. Výpočet je oproti přímému postupu pomalejší, zato nepodléhá tak velké numerické chybě.</p>
</section>
<section id="rungeho-jev">
<h3>Rungeho jev<a class="headerlink" href="#rungeho-jev" title="Link to this heading">#</a></h3>
<p>Polynomiální interpolace je vhodná zejmána pro funkce, které se svým tvarem polynomu blíží. Naopak některé funkce nejde aproximovat polynomem přesně a dochází k silným oscilacím mezi známými <em>ekvidistantními</em> body (<a class="reference external" href="https://cs.wikipedia.org/wiki/Rungeho_jev">Rungeho jev</a>).</p>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Aproximujte Rungeho funkci</p>
<div class="math notranslate nohighlight">
\[
f(x) = \frac{1}{1 + 25x^2}
\]</div>
<p>pomocí Lagrangeova interpolačního polynomu za použití <span class="math notranslate nohighlight">\( 12 \)</span> uniformě rozdělených bodů <span class="math notranslate nohighlight">\( x_i \)</span> na intervalu <span class="math notranslate nohighlight">\( [-1, 1] \)</span>, spočítejte absolutní chybu aproximace a vykreslete výsledky.</p>
</p>
</div>
</div> <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## DOPLŇTE ##</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">x_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">y_p</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span>
<span class="n">lag</span> <span class="o">=</span> <span class="n">lagrangeova_interpolace</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rungeho fce&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lag</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;lagrange. interp.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lag</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;abs. chyba&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05399dcac80d1b5c3e39b9d822ec3e46a8d9399341d9dcfc0d53df751c187428.png" src="../_images/05399dcac80d1b5c3e39b9d822ec3e46a8d9399341d9dcfc0d53df751c187428.png" />
</div>
</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #276BE9; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #DCE7FC; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Poznámka</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Tato ukázka ukazuje, že interpolace polynomem vysokého stupně na ekvidistatních bodech může být pro určité funkce problematická.</p>
</p>
</div>
</div></section>
<section id="cebysevova-interpolace">
<h3>Čebyševova interpolace<a class="headerlink" href="#cebysevova-interpolace" title="Link to this heading">#</a></h3>
<p>Pro aproximaci funkce <span class="math notranslate nohighlight">\(f(x)\)</span> ideálně hledáme <strong>nejlepší stejnoměrnou aproximaci</strong>, tedy funkci <span class="math notranslate nohighlight">\(h(x)\)</span>, která na daném intervalu <span class="math notranslate nohighlight">\([a,b]\)</span> minimalizuje hodnotu:</p>
<div class="math notranslate nohighlight">
\[
\max_{x \in [a,b]}{|f(x) - h(x)|}.
\]</div>
<p>Polynom, který je nejlepší stejnoměrnou aproximací funkce na daném intervalu <span class="math notranslate nohighlight">\([a,b]\)</span> mezi polynomy daného stupně, se někdy nazývá polynom <em>“minimax”</em>. Takový polynom <em>existuje za velmi obecných podmínek</em>, ale není znám jednoduchý postup, jak ho zkonstruovat (<a class="reference external" href="https://cs.wikipedia.org/wiki/Remez%C5%AFv_algoritmus">Remezův algoritmus</a>).</p>
<p><strong>Čebyševovy polynomy</strong></p>
<p>Aproximace Čebyševovými polynomy se lehce konstruuje a je téměr tak přesná, jako nejlepší stejnoměrná aproximace. Často se používá pro výpočet funkcí.</p>
<p>Oproti Lagrangeově interpolaci, Čebyševova interpolace využívá předem daných nerovnoměrně rozdělených bodů. Nelze ji tedy použít na interpolaci dat, u kterých si nemůžeme vybrat polohu <span class="math notranslate nohighlight">\(x_i\)</span>.</p>
<p>Čebyševovy polynomy jsou definovány na intervalu <span class="math notranslate nohighlight">\([-1, 1]\)</span> následovně:</p>
<div class="math notranslate nohighlight">
\[
T_n(x) = \cos(n \arccos(x)).
\]</div>
<p>Pro výpočet polynomu je vhodné použít rekurentní vztah:</p>
<div class="math notranslate nohighlight">
\[
T_{n}(x) = 2 x T_{n-1}(x) - T_{n-2}(x), \quad T_0(x) = 1, \ T_1(x) = x.
\]</div>
<p>Čebyševův polynom <span class="math notranslate nohighlight">\(T_n(x)\)</span> má <span class="math notranslate nohighlight">\(n\)</span> <strong>kořenů</strong> v intervalu <span class="math notranslate nohighlight">\([-1, 1]\)</span> v bodech:</p>
<div class="math notranslate nohighlight">
\[
x = \cos\left(\frac{\pi \left(k - \frac{1}{2}\right)}{n}\right), \quad k = 1, 2, \dots, n.
\]</div>
<p><strong>Aproximace pomocí Čebyševova polynomu</strong></p>
<ol class="arabic simple">
<li><p>Kořenů polynomu <span class="math notranslate nohighlight">\(T_n(x)\)</span> lze použít jako kořeny Lagrangeova polynomu pro snížení vlivu Rungeho jevu. Kořeny jsou více nahromaděny k okrajím intervalu, což vede k potlační oscilací. Pro <span class="math notranslate nohighlight">\(n &gt; 8\)</span> je však již výhodnější použít Čebyševova polynomu.</p></li>
<li><p><em>Čebyševova interpolace</em> - přímá konstukce Čebyševova polynomu jako aproximace funkce</p></li>
</ol>
<p>Čebyševova interpolace lze spočítat následovně:</p>
<div class="math notranslate nohighlight">
\[
f(x) \approx T(x) = \frac{1}{2} c_0 + \sum_{j=1}^{N-1}{c_j T_j(x)},
\]</div>
<p>kde</p>
<div class="math notranslate nohighlight">
\[
c_j = \frac{2}{N} \sum_{k=1}^{N} f\left[\cos\left(\frac{\pi \left(k - \frac{1}{2}\right)}{N}\right)\right] \cos\left(\frac{\pi j \left(k - \frac{1}{2}\right)}{n}\right).
\]</div>
<p>Hodnoty funkce <span class="math notranslate nohighlight">\(f(x)\)</span> jsou rovny hodnotám funkce <span class="math notranslate nohighlight">\(T(x)\)</span> ve všech <span class="math notranslate nohighlight">\(N\)</span> nulových bodech polynomu <span class="math notranslate nohighlight">\(T_N(x)\)</span>.</p>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #276BE9; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #DCE7FC; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Poznámka</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Všimněte si, že oproti Lagrangeově polynomu je tvar Čebyševových polynomů obecný. Pro získání Čebyševovy interpolace je třeba vyhodnotit funkci <span class="math notranslate nohighlight">\(f(x)\)</span> v kořenech polynomu <span class="math notranslate nohighlight">\(T_N(x)\)</span>.</p>
</p>
</div>
</div><div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Doplňte funkci <code class="docutils literal notranslate"><span class="pre">cebysevuv_polynom()</span></code>, která počítá koeficienty <a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_polynomials">Čebyševova polynomu</a> stupně <span class="math notranslate nohighlight">\( n \)</span> s využitím rekurentního vztahu.</p>
<p>Využijte k implementaci struktury <code class="docutils literal notranslate"><span class="pre">np.poly1d</span></code> (speciální pole koeficientů polynomu, operace s polynomy), která výrazně zjednodušuje práci s polynomy. Funkce by měla vracet polynom v tomto tvaru.</p>
<p>Vykreslete prvních 5 polynomů na intervalu <span class="math notranslate nohighlight">\([-1, 1]\)</span>.</p>
</p>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cebysevuv_polynom</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="c1">## DOPLŇTE ##</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">cp</span> <span class="o">=</span> <span class="n">cebysevuv_polynom</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">cp</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;n=</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Čebyševovy polynomy na [-1,1]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9ae3f66e2f096fbd0e7c2e16aba594d3f994dbbe07a55e211e7e31843677f441.png" src="../_images/9ae3f66e2f096fbd0e7c2e16aba594d3f994dbbe07a55e211e7e31843677f441.png" />
</div>
</div>
<p>Správnost implementace můžeme ověřit pomocí odpovídající knihovní funkce <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.eval_chebyt.html"><code class="docutils literal notranslate"><span class="pre">scipy.special.eval_chebyt</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">cebysevuv_polynom</span><span class="p">(</span><span class="n">n</span><span class="p">)(</span><span class="n">x</span><span class="p">),</span> <span class="n">special</span><span class="o">.</span><span class="n">eval_chebyt</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">E</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The implementation is correct.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The implementation is correct.
</pre></div>
</div>
</div>
</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Doplňte funkci <code class="docutils literal notranslate"><span class="pre">cebysev_koreny()</span></code>, která počítá kořeny <a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_polynomials">Čebyševova polynomu</a> stupně <span class="math notranslate nohighlight">\( n \)</span>.</p>
</p>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cebysev_koreny</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="c1">## DOPLŇTE ##</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cebysev_koreny</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cebysev_koreny</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.98768834 -0.89100652 -0.70710678 -0.4539905  -0.15643447  0.15643447
  0.4539905   0.70710678  0.89100652  0.98768834]
</pre></div>
</div>
<img alt="../_images/565c42a86dc60471515aa2cf05a779fe8a98d788f95d7465ce3e8f6124814cc0.png" src="../_images/565c42a86dc60471515aa2cf05a779fe8a98d788f95d7465ce3e8f6124814cc0.png" />
</div>
</div>
<p>Správnost implementace můžeme ověřit pomocí odpovídající knihovní funkce <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.roots_chebyt.html"><code class="docutils literal notranslate"><span class="pre">scipy.special.roots_chebyt</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">cebysev_koreny</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">special</span><span class="o">.</span><span class="n">roots_chebyt</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">E</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The implementation is correct.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The implementation is correct.
</pre></div>
</div>
</div>
</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Aproximujte Rungeho funkci</p>
<div class="math notranslate nohighlight">
\[
f(x) = \frac{1}{1 + 25x^2}
\]</div>
<p>pomocí Lagrangeova interpolačního polynomu za použití <span class="math notranslate nohighlight">\( 12 \)</span> uniformě rozdělených bodů <span class="math notranslate nohighlight">\( x_i \)</span> na intervalu <span class="math notranslate nohighlight">\( [-1, 1] \)</span>, spočítejte absolutní chybu aproximace a vykreslete výsledky.</p>
<p>na intervalu <span class="math notranslate nohighlight">\([ -1, 1] \)</span> pomocí Lagrangeova interpolačního polynomu za použití kořenů Čebyševova polynomu <span class="math notranslate nohighlight">\( 12 \)</span>-tého řádu. Spočítejte absolutní chybu aproximace a vykreslete výsledky.</p>
</p>
</div>
</div> <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## DOPLŇTE ##</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">12</span>
<span class="c1"># Lagrange</span>
<span class="n">x_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">y_p</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span>
<span class="n">lag</span> <span class="o">=</span> <span class="n">lagrangeova_interpolace</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">)</span>

<span class="c1"># Cebysev</span>
<span class="n">x_p</span> <span class="o">=</span> <span class="n">cebysev_koreny</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">y_p</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span>
<span class="n">lagceb</span> <span class="o">=</span> <span class="n">lagrangeova_interpolace</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rungeho fce&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lag</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;lagrange interp.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lagceb</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;lagrange-čebyšev. interp.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lag</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;abs. chyba lagrange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lagceb</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;abs. chyba lagrange-čebyšev&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0fad137a27e698323c4c67473483e5b8fc55e8ec6233a272e5efa8e31491ab46.png" src="../_images/0fad137a27e698323c4c67473483e5b8fc55e8ec6233a272e5efa8e31491ab46.png" />
</div>
</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #276BE9; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #DCE7FC; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Poznámka</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Čebyševovy polynomy jsou definované pouze na intervalu <span class="math notranslate nohighlight">\([-1, 1]\)</span>. Pokud chceme aproximovat funkci na obecn0m intervalu <span class="math notranslate nohighlight">\( [a, b] \neq [-1, 1] \)</span>, tak je třeba provést odpovídající transformaci.</p>
<p>Při výpočtu kořenů <span class="math notranslate nohighlight">\( x_i \)</span> Čebyševovy interpolace lze použít:</p>
<div class="math notranslate nohighlight">
\[
x_i = \frac{a + b}{2} + \frac{b - a}{2} z_i, \qquad i = 0, 1, \dots, n - 1.
\]</div>
<p>kde <span class="math notranslate nohighlight">\( z_i \)</span> je <span class="math notranslate nohighlight">\( i \)</span>-tý kořen Čebyševova polynomu <span class="math notranslate nohighlight">\( n \)</span>-tého stupně.</p>
<p>Při interpolaci lze libovolný interval <span class="math notranslate nohighlight">\([a, b]\)</span> transformovat na <span class="math notranslate nohighlight">\([-1, 1]\)</span> pomocí:</p>
<div class="math notranslate nohighlight">
\[
x = \frac{2 t - (a + b)}{b - a}, \quad x \in [-1, 1], \quad t \in [a,b].
\]</div>
</p>
</div>
</div></section>
</section>
<section id="modelovani-dat">
<h2>Modelování dat<a class="headerlink" href="#modelovani-dat" title="Link to this heading">#</a></h2>
<p>V této podkapitole se budeme zabývat úlohou velmi podobnou <strong>interpolaci</strong>. U interpolace je cílem získat aproximaci funkce, kterou dokážeme vyčíslit na konečném počtu bodů, na reálném intervalu. Funkci dokážeme vyčíslit přesně až na chybu numerické metody a zaokrouhlovací chyby.</p>
<p>Naopak v případě <strong>modelování dat</strong> uvažujeme data podléhající experimentálním nebo dalším chybám - data obsahují jistou míru šumu. Tedy jednotlivé data pointy se mohou významně odchylovat od skutečné hodnoty/funkce. V takovém případě nemá smysl provádět interpolaci, u které typicky chceme, aby aproximace přesně procházela známými data-pointy. U modelování, nebo také <em>fitování dat</em>, chceme proložit data vhodným modelem - křivkou. Tento model typicky známe z teorie, tedy je například znám určitý zákon nebo vzorec, kterým by se data měla řídit.</p>
<p>Ukážeme si metodu nejmenších čtverců, která pro libovolný tvar modelu najde <strong>nejpravděpodobnéjší hodnoty</strong> parametrů modelu vzhledem k daným datům (viz <em>Numerical Recipes kapitola 15</em>).</p>
<section id="metoda-nejmensich-ctvercu">
<h3>Metoda nejmenších čtverců<a class="headerlink" href="#metoda-nejmensich-ctvercu" title="Link to this heading">#</a></h3>
<p>Pro daných <span class="math notranslate nohighlight">\( n \)</span> známých data pointů <span class="math notranslate nohighlight">\( (x_{i}, y_{i}) \)</span>, <span class="math notranslate nohighlight">\( i = 0, 1, \dots, n-1 \)</span>, <a class="reference external" href="https://en.wikipedia.org/wiki/Least_squares">metoda nejmenších čtverců</a> hledá aproximaci k datům pomocí minimalizace součtu čtverců reziduí (odchylka dat od modelu):</p>
<div class="math notranslate nohighlight">
\[
S = \sum_{i = 0}^{n - 1} (y_i - f(x_i; \beta))^2,
\]</div>
<p>kde <span class="math notranslate nohighlight">\( f(x_i; \beta) \)</span> je modelová funkce a <span class="math notranslate nohighlight">\( \beta \)</span> je vektor parametrů modelu o velikosti <span class="math notranslate nohighlight">\( m \)</span>. K hledání minima <span class="math notranslate nohighlight">\( S \)</span> lze použít několik metod. <span class="math notranslate nohighlight">\( S \)</span> se v optimalizaci často nazývá <em>účelová funkce</em> nebo <em>chyba</em>.</p>
<p>Pokud je modelová funkce lineární ve všech parametrech <span class="math notranslate nohighlight">\(\beta_i\)</span>, lze minimum spočítat přímo položením gradientu rovnu <span class="math notranslate nohighlight">\( 0 \)</span>:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial S}{\partial \beta_j} = \sum_{i = 0}^{n - 1} 2 r_i \frac{\partial r_i}{\partial \beta_j} = \sum_{i = 0}^{n - 1} -2 \left( y_i - f(x_i; \beta) \right) \frac{\partial f(x_i; \beta)}{\partial \beta_j} = 0, \qquad j = 0, 1, \dots, m - 1. 
\]</div>
<p>V opačném případě lze použít jiné minimalizační metody, jako například metodu největšího spádu (uvidíme v <a class="reference internal" href="08-extremy-fci.html#extremy"><span class="std std-ref">kapitole 8</span></a>).</p>
<p><strong>Polynomiální modelová funkce</strong></p>
<p>V případě polynomiální modelové funkce:</p>
<div class="math notranslate nohighlight">
\[
f(x; \beta) = \beta_{m-1} x^{m-1} + \beta_{m-2} x^{m-2} + \dots + \beta_1 x + \beta_0,
\]</div>
<p>lze položit <span class="math notranslate nohighlight">\(\nabla S = 0\)</span> a převést hledání minima <span class="math notranslate nohighlight">\(S\)</span> na řešení soustavy lineárních rovnic.</p>
<p>Vektor <span class="math notranslate nohighlight">\( \beta \)</span>, který minimalizuje <span class="math notranslate nohighlight">\( S \)</span> lze tedy získat řešením systému <span class="math notranslate nohighlight">\( m \)</span> lineárních algebraických rovnic:</p>
<div class="math notranslate nohighlight">
\[
\sum_{i = 0}^{n - 1} \left( y_i - \beta_{m-1} x^{m-1} - \beta_{m-2} x^{m-2} - \dots - \beta_1 x - \beta_0 \right) x_i^j = 0, \qquad j = 0, 1, \dots, m - 1.
\]</div>
<p>Systém rovnic lze dále upravit na:</p>
<div class="math notranslate nohighlight">
\[
\beta_0 \sum_{i = 0}^{n - 1} x_i^j + \beta_1 \sum_{i = 0}^{n - 1} x_i^{j+1} + \dots + \sum_{i = 0}^{n - 1} \beta_{m-2} x_i^{j + m - 2} + \beta_{m-1} \sum_{i = 0}^{n - 1} x_i^{j + m-1} = \sum_{i = 0}^{n - 1} y_i x_i^j  
\]</div>
<p>a v maticové formě máme:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{pmatrix}
\sum 1 &amp; \sum x_i &amp; \cdots &amp; \sum x_i^{m-2} &amp; \sum x_i^{m-1} \\
\sum x_i &amp; \sum x_i^2 &amp; \cdots &amp; \sum x_i^{m-1} &amp; \sum x_i^{m} \\
\vdots &amp; \vdots &amp; \ddots  &amp; \vdots &amp; \vdots \\
\sum x_i^{m-2} &amp; \sum x_i^{m-1} &amp; \cdots &amp; \sum x_i^{2m-4} &amp; \sum x_i^{2m-3} \\
\sum x_i^{m-1} &amp; \sum x_i^{m} &amp; \cdots &amp; \sum x_i^{2m-3} &amp; \sum x_i^{2m-2} \\
\end{pmatrix} 
\begin{pmatrix}
\beta_0 \\
\beta_1 \\
\vdots\\
\beta_{m-2} \\
\beta_{m-1}
\end{pmatrix} 
=
\begin{pmatrix}
\sum y_i \\
\sum y_i x_i \\
\vdots\\
\sum y_i x_i^{m-2} \\
\sum y_i x_i^{m-1}
\end{pmatrix}.
\end{split}\]</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Implementujte metodu nejmenších čtverců s polynomiálním modelem pro obecný stupeň polynomu <span class="math notranslate nohighlight">\(n\)</span>. Funkce <code class="docutils literal notranslate"><span class="pre">polynom_nejmensi_ctverce()</span></code> by měla vrátit koeficienty polynomu ve formátu <code class="docutils literal notranslate"><span class="pre">np.poly1d</span></code>.</p>
</p>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">polynom_nejmensi_ctverce</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="c1">## DOPLŇTE ##</span>

<span class="n">x_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
<span class="n">y_p</span> <span class="o">=</span> <span class="n">x_p</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.08</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x_p</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_p</span><span class="p">))</span>
<span class="n">pfit</span> <span class="o">=</span> <span class="n">polynom_nejmensi_ctverce</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pfit</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[10.          1.6074033   1.03128341]
 [ 1.6074033   1.03128341  0.30074111]
 [ 1.03128341  0.30074111  0.15042872]]
</pre></div>
</div>
<img alt="../_images/50b2bd168104afb84332188d90b66800486ab969200b0ad442359ad344f5cd94.png" src="../_images/50b2bd168104afb84332188d90b66800486ab969200b0ad442359ad344f5cd94.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">polynom_nejmensi_ctverce</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">E</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The implementation is correct.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[10.          3.44087536]
 [ 3.44087536  2.00984499]]
The implementation is correct.
</pre></div>
</div>
</div>
</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Použijte funkci <code class="docutils literal notranslate"><span class="pre">polynom_nejmensi_ctverce()</span></code> pro fitování následujících dat, které byly vygenerovány z polynomiální funkce s přidáním gaussovského šumu. Odhadněte z tvaru dat vhodný stupeň fitovaného polynomu. Vyzkoušejte fit pro různé stupně, spočítejte výslednou chybu <span class="math notranslate nohighlight">\(S\)</span> a porovnejte ji pro různé stupně polynomiálního fitu.</p>
</p>
</div>
</div><p>Vygenerování dat</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

<span class="n">xdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span>
<span class="n">ydata</span> <span class="o">=</span> <span class="n">poly</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>
<span class="n">ydata</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ydata</span><span class="p">)),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>
<span class="n">xdataSort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        4         3        2
-1.035 x - 1.313 x - 1.81 x + 0.7911 x + 0.6889
</pre></div>
</div>
<img alt="../_images/8f920acaad129dcee4ed4a6627fc6c168e7373809ef8f0353b9f5ddfde820779.png" src="../_images/8f920acaad129dcee4ed4a6627fc6c168e7373809ef8f0353b9f5ddfde820779.png" />
</div>
</div>
<p>Polynomiální fit</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## DOPLŇTE ##</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>error = 502.58708108497
</pre></div>
</div>
<img alt="../_images/5d34d21a3fe870f359f65bd8b53d866444a6f335bf56218d7f7d7ab55e12589e.png" src="../_images/5d34d21a3fe870f359f65bd8b53d866444a6f335bf56218d7f7d7ab55e12589e.png" />
</div>
</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol - zápočet 4</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p><a class="reference internal" href="../ukoly/05-aproximace-funkci-UKOL.html#ukol4"><span class="std std-ref">ZDE</span></a></p>
</p>
</div>
</div></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lekce"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../lekce-vyplnene/04-linalg-iter-vypl.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Iterační metody lineární algebry</p>
      </div>
    </a>
    <a class="right-next"
       href="07-nelinearni-rce.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Řešení nelineárních rovnic</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lokalni-interpolace">Lokální interpolace</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linearni-interpolace">Lineární interpolace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolacni-spline">Interpolační spline</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#globalni-interpolace">Globální interpolace</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lagrangeova-interpolace">Lagrangeova interpolace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nevilluv-algoritmus">Nevillův algoritmus</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rungeho-jev">Rungeho jev</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cebysevova-interpolace">Čebyševova interpolace</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelovani-dat">Modelování dat</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metoda-nejmensich-ctvercu">Metoda nejmenších čtverců</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jiří Löffelmann
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>