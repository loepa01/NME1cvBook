
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Metody lineární algebry &#8212; NME1cvBook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lekce/03-linalg-prime';</script>
    <link rel="icon" href="../_static/cphys2.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Iterační metody lineární algebry" href="04-linalg-iter.html" />
    <link rel="prev" title="Numerické chyby a stabilita" href="../lekce-vyplnene/02-chyby-stabilita-vypl.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/cphys-logo6.png" class="logo__image only-light" alt="NME1cvBook - Home"/>
    <script>document.write(`<img src="../_static/cphys-logo6.png" class="logo__image only-dark" alt="NME1cvBook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Numerické metody (NME1cv) - cvičení 2025
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Obsah cvičení</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../lekce-vyplnene/01-uvod-python-vypl.html">1. Úvod do jazyka Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lekce-vyplnene/02-chyby-stabilita-vypl.html">2. Numerické chyby a stabilita</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Metody lineární algebry</a></li>
<li class="toctree-l1"><a class="reference internal" href="04-linalg-iter.html">4. Iterační metody lineární algebry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lekce-vyplnene/05-aproximace-funkci-vypl.html">5. Aproximace funkcí</a></li>
<li class="toctree-l1"><a class="reference internal" href="07-nelinearni-rce.html">7. Nelineární rovnice</a></li>
<li class="toctree-l1"><a class="reference internal" href="08-extremy-fci.html">8. Extrémy funkcí</a></li>
<li class="toctree-l1"><a class="reference internal" href="09-integrace.html">9. Numerická integrace</a></li>
<li class="toctree-l1"><a class="reference internal" href="10-reseni-odr.html">10. Obyčejné diferenciální rovnice</a></li>
<li class="toctree-l1"><a class="reference internal" href="11-reseni-okraj.html">11. Diferenciální rovnice s okrajovou podmínkou</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Úkoly</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ukoly/02-chyby-stabilita-UKOL.html">2. Numerické chyby a stabilita</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/03-linalg-prime-UKOL.html">3. Metody lineární algebry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/04-linalg-iter-UKOL.html">4. Iterační metody lineární algebry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/05-aproximace-funkci-UKOL.html">5. Aproximace funkcí</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/07-nelinearni-rce-UKOL.html">7. Nelineární rovnice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/08-extremy-fci-UKOL.html">8. Extrémy funkcí</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/09-integrace-UKOL.html">9. Numerická integrace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/10-reseni-odr-UKOL.html">10. Obyčejné diferenciální rovnice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ukoly/11-reseni-okraj-UKOL.html">11. Diferenciální rovnice s okrajovou podmínkou</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/loepa01/NME1cvBook/main?urlpath=lab/tree/lekce/03-linalg-prime.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://jupyter.fjfi.cvut.cz/hub/user-redirect/git-pull?repo=https%3A//github.com/loepa01/NME1cvBook&urlpath=lab/tree/NME1cvBook/lekce/03-linalg-prime.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/loepa01/NME1cvBook/blob/main/lekce/03-linalg-prime.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/loepa01/NME1cvBook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/loepa01/NME1cvBook/issues/new?title=Issue%20on%20page%20%2Flekce/03-linalg-prime.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lekce/03-linalg-prime.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Metody lineární algebry</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#zakladni-operace-s-maticemi">Základní operace s maticemi</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skalarni-soucin">Skalární součin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#soucin-matice-s-vektorem">Součin matice s vektorem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#soucin-matice-s-matici">Součin matice s maticí</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reseni-soustavy-linearnich-rovnic">Řešení soustavy lineárních rovnic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prime-metody-pro-reseni-soustavy-linearnich-rovnic">Přímé metody pro řešení soustavy lineárních rovnic</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussova-eliminace">Gaussova eliminace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gauss-jordanova-eliminace">Gauss-Jordanova eliminace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thomasuv-algoritmus">Thomasův algoritmus</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lu-dekompozice">LU dekompozice</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#iterativniho-zpresneni-reseni">Iterativního zpřesnění řešení</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#zapoctova-uloha">Zápočtová úloha</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="metody-linearni-algebry">
<h1>Metody lineární algebry<a class="headerlink" href="#metody-linearni-algebry" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span> <span class="k">as</span> <span class="nn">la</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<section id="zakladni-operace-s-maticemi">
<h2>Základní operace s maticemi<a class="headerlink" href="#zakladni-operace-s-maticemi" title="Link to this heading">#</a></h2>
<section id="skalarni-soucin">
<h3>Skalární součin<a class="headerlink" href="#skalarni-soucin" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Dot_product">Skalární součin</a> dvou vektorů <span class="math notranslate nohighlight">\( \vec{x} \in \mathbb{R}^{n} \)</span> a <span class="math notranslate nohighlight">\( \vec{y} \in \mathbb{R}^{n} \)</span> je definován následovně:</p>
<div class="math notranslate nohighlight">
\[
\vec{x} \cdot \vec{y} = \sum_{i=0}^{n-1} x_i y_i.
\]</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Napište funkci, která počítá skalární součin dvou vektorů. Nepoužijte žádné knihovní funkce (<code class="docutils literal notranslate"><span class="pre">np.dot()</span></code> nebo operátoru <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>). Zkontrolujte správnost pomocí vhodné knihovní funkce.</p>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #00843F; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #D6ECE1; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Tip</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<ul class="simple">
<li><p>Pro získání rozměrů matice nebo vektoru můžete použít <code class="docutils literal notranslate"><span class="pre">x.shape</span></code>, <code class="docutils literal notranslate"><span class="pre">A.shape[i]</span></code> (velikost v i-tém směru) nebo <code class="docutils literal notranslate"><span class="pre">np.shape(A)[i]</span></code>.</p></li>
<li><p>Pro procházení dvou polí najednou lze použít konstrukce <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">(xi,yi)</span> <span class="pre">in</span> <span class="pre">zip(x,y):</span></code>.</p></li>
<li><p>Nový vektor vytvářejte pomocí <code class="docutils literal notranslate"><span class="pre">np.zero()</span></code>.</p></li>
</ul>
</p>
</div>
</div>
</p>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">skalarni_soucin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1">## DOPLŇTE ##</span>

<span class="nb">print</span><span class="p">(</span><span class="n">skalarni_soucin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.83139346 0.13063298 0.57990023] [0.59881827 0.20268352 0.02221312]
0.5372121429785394 0.5372121429785394
</pre></div>
</div>
</div>
</div>
</section>
<section id="soucin-matice-s-vektorem">
<h3>Součin matice s vektorem<a class="headerlink" href="#soucin-matice-s-vektorem" title="Link to this heading">#</a></h3>
<p>Součin matice <span class="math notranslate nohighlight">\( \mathbb{A} \in \mathbb{R}^{m \ \times \ n} \)</span> a vektoru <span class="math notranslate nohighlight">\( \vec{x} \in \mathbb{R}^{n} \)</span> je definován následovně:</p>
<div class="math notranslate nohighlight">
\[
y_i = (\mathbb{A} \cdot \vec{x})_i = \sum_{j = 0}^{n-1} a_{ij} x_j, \quad i = 0, 1, \dots, m-1.
\]</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Napište funkci, která počítá součin matice s vektorem. Nepoužijte žádné knihovní funkce (<code class="docutils literal notranslate"><span class="pre">np.dot()</span></code> nebo operátoru <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>). Zkontrolujte správnost pomocí vhodné knihovní funkce. Lze využít předchozí funkci <code class="docutils literal notranslate"><span class="pre">skalarni_soucin()</span></code>.</p>
</p>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">soucin_matice_vektor</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="c1">## DOPLŇTE ##</span>

<span class="nb">print</span><span class="p">(</span><span class="n">soucin_matice_vektor</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.772886   0.22015307 0.76517971 0.06616971]
 [0.83894046 0.2041534  0.86375422 0.5972472 ]
 [0.34786499 0.6228571  0.35128022 0.68299252]] [0.23429355 0.56975239 0.07411743 0.6347202 ]
[0.40522735 0.75597933 0.89592198] [0.40522735 0.75597933 0.89592198]
</pre></div>
</div>
</div>
</div>
</section>
<section id="soucin-matice-s-matici">
<h3>Součin matice s maticí<a class="headerlink" href="#soucin-matice-s-matici" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Matrix_multiplication">Součin dvou matic</a> <span class="math notranslate nohighlight">\( \mathbb{A} \in \mathbb{R}^{m \ \times \ n}  \)</span> a <span class="math notranslate nohighlight">\( \mathbb{B} \in \mathbb{R}^{n \ \times \ p}  \)</span> je definován následovně:</p>
<div class="math notranslate nohighlight">
\[
(\mathbb{A} \cdot \mathbb{B})_{ij} = \sum_{k = 0}^{n-1} a_{ik} b_{kj}, \qquad i = 0, 1, \dots, m-1, \quad j = 0, 1, \dots, p-1.
\]</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Napište funkci, která počítá součin dvou matic. Nepoužijte žádné knihovní funkce (<code class="docutils literal notranslate"><span class="pre">np.dot()</span></code> nebo operátoru <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>). Zkontrolujte správnost pomocí vhodné knihovní funkce.</p>
</p>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">soucin_matic</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="c1">## DOPLŇTE ##</span>

<span class="nb">print</span><span class="p">(</span><span class="n">soucin_matic</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">))</span>        
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.93900362 0.93254905 0.8398923  0.59719839]
 [0.21166823 0.47156266 0.00412861 0.90073539]
 [0.76013947 0.96621237 0.7792041  0.62534165]]
[[0.57859143 0.18468811 0.87793734]
 [0.59642606 0.62035412 0.31216708]
 [0.50617326 0.34315774 0.90202306]
 [0.53664633 0.29167536 0.64022396]]
[[1.84511135 1.21433705 2.25544038]
 [0.88918782 0.59576753 0.91343427]
 [1.746084   1.18956922 2.07219329]]
[[1.84511135 1.21433705 2.25544038]
 [0.88918782 0.59576753 0.91343427]
 [1.746084   1.18956922 2.07219329]]
</pre></div>
</div>
</div>
</div>
<p>K snadnějšímu otestování správnosti lze použít následující funkci, která porovná výsledeky na zvolený počet míst:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">soucin_matic</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">),</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">E</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The implementation is correct.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The implementation is correct.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="reseni-soustavy-linearnich-rovnic">
<h2>Řešení soustavy lineárních rovnic<a class="headerlink" href="#reseni-soustavy-linearnich-rovnic" title="Link to this heading">#</a></h2>
<p>Hlavní úlohou lineární algebry je řešení soustavy rovnic. Tuto úlohu dokáže počítač řešit stejně jako člověk, jelikož jsou známy algoritmy s konečným počtem kroků. Stačí tedy provést konečný počet aritmetických operací s konečným počtem čísel.</p>
<p>Jelikož tento typ lze snadno řešit na počítači, často se jiné úlohy převádí právě na soustavu lineárních rovnic, kterou dokážeme řešit. Příkladem tohoto postupu je řešení <em>obyčejných diferenciálních rovnic</em> (ODR) nebo <em>parciálních diferenciálních rovnic</em> (PDR), se kterými se setkáme v <a class="reference internal" href="11-reseni-okraj.html#metoda-siti"><span class="std std-ref">poslední kapitole</span></a>.</p>
<p>Matematicky můžeme problém zapsat následovně:</p>
<div class="math notranslate nohighlight">
\[
\mathbb{A}\vec{x} = \vec{b}.
\]</div>
<p>Metody řešící soustavu lineárních rovnic můžeme rozdělit do tří skupin:</p>
<ul class="simple">
<li><p><strong>Metody přímé</strong> - přímý běh s daným počtem kroků podle velikosti matice</p></li>
<li><p><strong>Metody iterační</strong> - postupné zpřesňování výsledku</p></li>
<li><p><strong>Metody optimalizační</strong> - minimalizace funkce <span class="math notranslate nohighlight">\(|\mathbb{A}\vec{x} - \vec{b}|\)</span> gradientími metodami (viz <a class="reference internal" href="08-extremy-fci.html#extremy"><span class="std std-ref">kapitola 8</span></a>)</p></li>
</ul>
</section>
<section id="prime-metody-pro-reseni-soustavy-linearnich-rovnic">
<h2>Přímé metody pro řešení soustavy lineárních rovnic<a class="headerlink" href="#prime-metody-pro-reseni-soustavy-linearnich-rovnic" title="Link to this heading">#</a></h2>
<section id="gaussova-eliminace">
<h3>Gaussova eliminace<a class="headerlink" href="#gaussova-eliminace" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_elimination">Gaussova eleminace</a> je algoritmus, který transformuje libovolnou matici na horní (nebo dolní) trojúhelníkovou. To výrazně zjednodušší celou soustavu. Řešení pak lze spočítat pomocí tzv. <em>zpětného běhu</em>. Jednotlivé kroky celého algoritmu si zde ukážeme.</p>
<p>Je to vlastně zobecněný postup eliminace členů v soustavě rovnic. Podobný postup známe již ze střední - sčítání/odčítání rovnic s cílem eliminovat dostatek členů tak, abychom mohli postupně vyjádřit a spočítat jednotlivé složky řešení.</p>
<p><img alt="Gaussova eliminace postup" src="../_images/gauss_elim.png" /></p>
<p><strong>Dopředný běh</strong></p>
<p>Matici <span class="math notranslate nohighlight">\( \mathbb{A} \in \mathbb{R}^{n \ \times \ n} \)</span> je možné transformovat na horní trojúhelníkovou pomocí vzorce:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
a_{jk} &amp;:= a_{jk} - \frac{a_{ji}}{a_{ii}} a_{ik}, \qquad i = 0, 1, \dots, n-1, \quad j = i + 1, i + 2, \dots, n-1, \quad k = 0, 1, \dots, n-1, \\
b_{j} &amp;:= b_{j}- \frac{a_{ji}}{a_{ii}} b_{i}, \qquad i = 0, 1, \dots, n-1, \quad j = i + 1, i + 2, \dots, n-1.
\end{align}
\end{split}\]</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Implementujte Gaussovu eliminaci, tedy převedení libovolné matice na horní trojúhelníkovou, pomocí uvedeného vzorce. Jaká je složitost celého algoritmu?</p>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #00843F; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #D6ECE1; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Tip</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Dejte si pozor na nechtěné přepsání hodnoty <span class="math notranslate nohighlight">\(a_{ji}\)</span>, která je potřeba k aktualizaci celého řádku!</p>
</p>
</div>
</div>
</p>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">gauss_elim_dopredna</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1">## DOPLŇTE ##</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span>
            <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">,</span><span class="n">b</span>

<span class="n">B</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">gauss_elim_dopredna</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>     
<span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.9914132  0.9120253  0.93381036 0.48088198]
 [0.17055387 0.71826111 0.06099502 0.55454411]
 [0.53817095 0.35579706 0.89299434 0.10290006]
 [0.51595647 0.43741892 0.57752847 0.79708226]] [0.32254751 0.97139026 0.59510652 0.31278152]
[[ 0.9914132   0.9120253   0.93381036  0.48088198]
 [ 0.          0.56136442 -0.09964938  0.47181747]
 [ 0.          0.          0.36136816 -0.04107597]
 [ 0.          0.          0.          0.58775892]]
</pre></div>
</div>
</div>
</div>
<p><strong>Zpětný běh</strong></p>
<p>Soustava lineárních rovnic <span class="math notranslate nohighlight">\( \mathbb{A} x = b \)</span> s horní trojúhelníkovou maticí <span class="math notranslate nohighlight">\( \mathbb{A} \in \mathbb{R}^{n \ \times \ n} \)</span> je možné vyřešit pomocí <a class="reference external" href="https://en.wikipedia.org/wiki/Triangular_matrix#Forward_and_back_substitution">zpětné substituce</a> neboli <em>zpětného běhu Gaussovy eliminace</em>:</p>
<div class="math notranslate nohighlight">
\[
x_i := \frac{1}{a_{ii}} \left( b_i - \sum_{j = i + 1}^{n-1} a_{ij} x_j \right), \qquad i = n-1, n-2, \dots, 0.
\]</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Implementujte zpětný běh Gaussovy eliminace, tedy řešení soustavy linerních rovnic s trojúhelníkovou maticí, pomocí uvedeného vzorce. Správnost ověřte pomocí knihovní funkce <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.solve.html"><code class="docutils literal notranslate"><span class="pre">scipy.linalg.solve()</span></code></a>.</p>
</p>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="c1"># vynuluje v matici cisla pod diagonalou</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">gauss_elim_zpetny</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="c1">## DOPLŇTE ##</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="nb">print</span><span class="p">(</span><span class="n">gauss_elim_zpetny</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">la</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span> <span class="c1"># kontrola</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.99238736 0.91444374 0.74467695 0.67980813]
 [0.         0.43783844 0.97596445 0.33957138]
 [0.         0.         0.45236023 0.43979398]
 [0.         0.         0.         0.91868856]] [0.84833208 0.96539183 0.43887978 0.87205561]
[-1.08706757  1.3632094   0.04732931  0.94923966]
[-1.08706757  1.3632094   0.04732931  0.94923966]
</pre></div>
</div>
</div>
</div>
<p>Teď již stačí jen použít obě metody na řešení libovolné soustavy linearních rovnic:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">gauss_elimimace</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="n">A</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">gauss_elim_dopredna</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gauss_elim_zpetny</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">gauss_elimimace</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">E</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The implementation is correct.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.66262611 0.29301267 0.59422536 0.07276833]
 [0.14685898 0.71236235 0.5528195  0.17417942]
 [0.68757098 0.47889717 0.18110509 0.628472  ]
 [0.51145855 0.64432575 0.37681061 0.46435004]] [0.9254799  0.68494708 0.65224819 0.30197395]
The implementation is correct.
</pre></div>
</div>
</div>
</div>
<p><strong>Pivoting</strong></p>
<p>V této podkapitole si ukážeme několik numerických komplikací, které u Gaussovy eliminace můžou nastat.</p>
<p>Prvním zřejmým problémem je situace, kdy je přední prvek matice (<em>pivot</em>) rovný nule. Ten nemůžeme použít, protože bychom dělili při eliminaci spodních řádků nulou!</p>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Použijte Gaussovu eliminaci <code class="docutils literal notranslate"><span class="pre">gauss_elimimace()</span></code> na řešení soustavy s maticí:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbb{A} = \begin{pmatrix}
0 &amp; 1 \\
1 &amp; 1
\end{pmatrix}.
\end{split}\]</div>
</p>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## DOPLŇTE ##</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\jiral\AppData\Local\Temp\ipykernel_20156\339819762.py:13: RuntimeWarning: divide by zero encountered in long_scalars
  A[j,k] -= a / A[i,i] * A[i,k]
C:\Users\jiral\AppData\Local\Temp\ipykernel_20156\339819762.py:13: RuntimeWarning: invalid value encountered in double_scalars
  A[j,k] -= a / A[i,i] * A[i,k]
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">219</span><span class="p">],</span> <span class="n">line</span> <span class="mi">6</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="nb">print</span><span class="p">(</span><span class="n">gauss_elimimace</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

<span class="nn">Cell In [218], line 6,</span> in <span class="ni">gauss_elimimace</span><span class="nt">(A, b)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="k">def</span> <span class="nf">gauss_elimimace</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
<span class="ne">----&gt; </span><span class="mi">6</span>     <span class="n">A</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">gauss_elim_dopredna</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="k">return</span> <span class="n">gauss_elim_zpetny</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nn">Cell In [216], line 13,</span> in <span class="ni">gauss_elim_dopredna</span><span class="nt">(A, b)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>         <span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>         <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<span class="ne">---&gt; </span><span class="mi">13</span>             <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span>         <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="k">return</span> <span class="n">A</span><span class="p">,</span><span class="n">b</span>

<span class="ne">ValueError</span>: cannot convert float NaN to integer
</pre></div>
</div>
</div>
</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #F4330C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #F7C8C0; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Pozor</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Gaussova eliminace nedokáže matici s nulovými prvky na diagonále převést na horní trojúhelníkovou.</p>
</p>
</div>
</div><p>Druhý problém nastává, pokud je pivot velmi malý. Tedy na diagonále matice se nachází velmi nízké hodnoty.</p>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Použijte Gaussovu eliminaci <code class="docutils literal notranslate"><span class="pre">gauss_elimimace()</span></code> na řešení soustavy s maticí a pravou stranou:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbb{A} = \begin{pmatrix}
10^{-10} &amp; 2 &amp; 3 \\
4 &amp; 5 &amp; 6 \\
7 &amp; 8 &amp; 9
\end{pmatrix}, \quad \vec{b} = \begin{pmatrix}
1 \\
0.1  \\
0.01
\end{pmatrix}.
\end{split}\]</div>
<p>Výsledek porovnejte s řešením získaným pomocí knihovní funkce <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.solve.html"><code class="docutils literal notranslate"><span class="pre">scipy.linalg.solve()</span></code></a>.</p>
</p>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## DOPLŇTE ##</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.8010025   1.30401611 -0.53601074]
[-0.801  1.304 -0.536]
</pre></div>
</div>
</div>
</div>
<p>Vidíme, že dostáváme výsledek s nezanedbatelnou chybou! Podobný příklad můžete vidět <a class="reference external" href="http://kfe.fjfi.cvut.cz/~vachal/edu/nme/cviceni/02_linalg/DOCS/priklad_pivoting.pdf">zde</a>.</p>
<p>Chyba vzniká zaokrouhlováním při odčítání velmi odlišných čísel. Při použití malého pivota odčítáme od hodnot v matici vysoké číslo, čímž vzníká velká chyba (výrazně větší než strojová přesnost <span class="math notranslate nohighlight">\(\varepsilon\)</span>).</p>
<p>Dalším problémem je, že malé hodnoty v matici mohou vznikat odečtením blízkých hodnot v předchozích krocích. Nasledné použití této hodnoty jako pivota vede k silnému hromadění chyb!</p>
<p>Předchozím problémům se lze vyhnout vhodným výběrem pivota (tzv. <em>pivotingem</em>). Vhodný pivot je největší dostupné číslo. Máme několik strategií, jak pivota vybrat:</p>
<p><img alt="Pivoting strategie" src="../_images/pivoting.png" /></p>
<ol class="arabic simple">
<li><p><strong>úplný pivoting</strong> - výběr z celé dosud neupravené části matice <span class="math notranslate nohighlight">\(\max{|a_{jk}|}\)</span> (nevýhoda: znatelně zpomaluje výpočet)</p></li>
<li><p><strong>částečný pivoting</strong> - výběr v daném sloupci (<em>sloupcový</em>) a řádku (<em>řádkový</em>)</p></li>
<li><p><strong>implicitní pivoting</strong> - rychlejší verze sloupcového pivotingu, při výběru je porovnána velikost prvků v daném sloupci normovaném na maximum z prvků v jednotlivých řádcích původní matice</p></li>
</ol>
<p>Při výběru pivota z jiného řádku je třeba prohodit odpovídající řádky a pravou stranu. V případě volby pivota v jiném sloupci je třeba prohodit navíc složky hledaného řešení.</p>
<p>V praxi většinou stačí <em>částečný</em> nebo i <em>sloupcový pivoting</em>.</p>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Modifikujte Gaussovu eliminační metodu pomocí tak, že použijete <em>sloupcový pivoting</em>. Ověřte zlepšení přesnosti na řešení předcházející soustavy rovnic. Stačí upravit zpětný chod <code class="docutils literal notranslate"><span class="pre">gauss_elim_dopredna()</span></code>.</p>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #00843F; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #D6ECE1; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Tip</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Pro nalezení největšího prvku se může hodit funkce <code class="docutils literal notranslate"><span class="pre">np.argmax()</span></code>. Pro prohození řádků lze použít <code class="docutils literal notranslate"><span class="pre">np.copy()</span></code> (pro uložení přepisovaného řádku do pomocné proměné) nebo pokročilého Numpy řezu <code class="docutils literal notranslate"><span class="pre">A[[i,j],:]</span> <span class="pre">=</span> <span class="pre">A[[j,i],:]</span></code> (prohodí řádky <span class="math notranslate nohighlight">\(i,j\)</span>).</p>
</p>
</div>
</div>
</p>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">gauss_elim_dopredna_pivoting</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1">## DOPLŇTE ##</span>

<span class="k">def</span> <span class="nf">gauss_elimimace_pivoting</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="n">A</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">gauss_elim_dopredna_pivoting</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gauss_elim_zpetny</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">gauss_elimimace_pivoting</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">la</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
[[7.e+00 8.e+00 9.e+00]
 [4.e+00 5.e+00 6.e+00]
 [1.e-10 2.e+00 3.e+00]] [0.001 0.1   1.   ]
[[7.         8.         9.        ]
 [0.         0.42857143 0.85714286]
 [0.         2.         3.        ]] [0.001      0.09942857 1.        ]
2
[[7.         8.         9.        ]
 [0.         2.         3.        ]
 [0.         0.42857143 0.85714286]] [0.001      1.         0.09942857]
[[7.         8.         9.        ]
 [0.         2.         3.        ]
 [0.         0.         0.21428571]] [ 0.001       1.         -0.11485714]
2
[[7.         8.         9.        ]
 [0.         2.         3.        ]
 [0.         0.         0.21428571]] [ 0.001       1.         -0.11485714]
[[7.         8.         9.        ]
 [0.         2.         3.        ]
 [0.         0.         0.21428571]] [ 0.001       1.         -0.11485714]
[-0.801  1.304 -0.536]
[-0.801  1.304 -0.536]
</pre></div>
</div>
</div>
</div>
</section>
<section id="gauss-jordanova-eliminace">
<h3>Gauss-Jordanova eliminace<a class="headerlink" href="#gauss-jordanova-eliminace" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Matici <span class="math notranslate nohighlight">\(\mathbb{A}\)</span> převedeme na tvar, kdy jsou na hlavní diagonále samé jedničky</p></li>
<li><p>Touto metodou lze získat i inverzní matici <span class="math notranslate nohighlight">\(\mathbb{A}^{-1}\)</span></p></li>
<li><p><a class="reference external" href="http://kfe.fjfi.cvut.cz/~vachal/edu/nme/cviceni/02_linalg/DOCS/priklad_GaussJordan.pdf">Ukázka</a></p></li>
</ul>
</section>
<section id="thomasuv-algoritmus">
<h3>Thomasův algoritmus<a class="headerlink" href="#thomasuv-algoritmus" title="Link to this heading">#</a></h3>
<p>Pro speciální typy matic existují efektivnější algoritmy, které najdou řešení ve výrazně kratším čase. Příkladem je soustava s tridiagonální maticí. Pro takovou matici nemusíme provádět celou Gaussovu eliminaci, ale jen výrazně redukovaný počet kroků (stačí eliminovat pouze vedlejší diagonály).</p>
<p>Systém <span class="math notranslate nohighlight">\( \mathbb{A} \vec{x} = \vec{b} \)</span> s tridiagonální maticí <span class="math notranslate nohighlight">\( \mathbb{A} \)</span> lze efektivně řešit pomocí <a class="reference external" href="https://en.wikipedia.org/wiki/Tridiagonal_matrix_algorithm">Thomasova algoritmu</a>. Tridiagonální matici <span class="math notranslate nohighlight">\( \mathbb{A} \)</span> můžeme reprezentovat pomocí tří vektorů <span class="math notranslate nohighlight">\( \vec{p} \)</span>, <span class="math notranslate nohighlight">\( \vec{q} \)</span>, and <span class="math notranslate nohighlight">\( \vec{r} \)</span> následovně:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbb{A} = \begin{pmatrix}
q_0 &amp; p_0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 \\
r_1 &amp; q_1 &amp; p_1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; r_2 &amp; q_2 &amp; p_2 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 \\
\vdots  &amp; \vdots  &amp; \ddots &amp; \ddots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots \\
\vdots  &amp; \vdots  &amp; \vdots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \vdots &amp; \vdots \\
\vdots  &amp; \vdots  &amp; \vdots &amp; \vdots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; r_{n-2} &amp; q_{n-2} &amp; p_{n-2} \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; r_{n-1} &amp; q_{n-1}
\end{pmatrix},
\end{split}\]</div>
<p>kde <span class="math notranslate nohighlight">\( p_{n-1} = 0 \)</span> and <span class="math notranslate nohighlight">\( r_0 = 0 \)</span>. Řešení <span class="math notranslate nohighlight">\( \mathbb{A} x = b \)</span> získáme <em>zpětným během</em> eliminace:</p>
<div class="math notranslate nohighlight">
\[
x_i = \mu_i x_{i+1} + \rho_i, \qquad i = n-1, n-2, \dots, 0,
\]</div>
<p>kde koeficienty <span class="math notranslate nohighlight">\( \mu_i \)</span> a <span class="math notranslate nohighlight">\( \rho_i \)</span> jsou získány při <em>dopředném běhu</em>:</p>
<div class="math notranslate nohighlight">
\[
\mu_i = -\frac{p_i}{r_i \mu_{i-1} + q_i}, \qquad \rho_i = \frac{b_i - r_i \rho_{i-1}}{r_i \mu_{i-1} + q_i}, \qquad i = 1, 2, \dots, n-1
\]</div>
<p>kde <span class="math notranslate nohighlight">\( \mu_0 = -p_0 \, / \, q_0 \)</span>, <span class="math notranslate nohighlight">\( \rho_0 = b_0 \, / \, q_0 \)</span> a <span class="math notranslate nohighlight">\(\mu_{n-1}=0\)</span>.</p>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Implementujte Thomasův algoritmus pomocí uvedených vzorců. Nejprve je třeba provést <em>dopředný běh</em> (výpočet <span class="math notranslate nohighlight">\(\mu\)</span> a <span class="math notranslate nohighlight">\(\rho\)</span>) a následně <em>zpětný běh</em>. Správnost ověřte pomocí knihovní funkce <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.solve.html"><code class="docutils literal notranslate"><span class="pre">scipy.linalg.solve()</span></code></a>.</p>
</p>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">thomas_alg</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="c1">## DOPLŇTE ##</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">thomas_alg</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">la</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.36653253 0.01789338 0.         0.         0.        ]
 [0.76320804 0.75026937 0.52011663 0.         0.        ]
 [0.         0.5319773  0.6195286  0.7682034  0.        ]
 [0.         0.         0.229951   0.02978361 0.92169446]
 [0.         0.         0.         0.2992984  0.80208829]] [0.10680473 0.68029879 0.03262974 0.06259222 0.90601487]
[ 0.1388284   3.12515556 -3.40378397  0.62334982  0.89696768]
[ 0.1388284   3.12515556 -3.40378397  0.62334982  0.89696768]
</pre></div>
</div>
</div>
</div>
</section>
<section id="lu-dekompozice">
<span id="lu-decomp"></span><h3>LU dekompozice<a class="headerlink" href="#lu-dekompozice" title="Link to this heading">#</a></h3>
<p><img alt="LU dekompozice obrázek" src="../_images/lu_decomp.png" /></p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/LU_decomposition">LU dekompozice</a> rozděluje matici na součin spodní a hodní trojúhelníkové matice. Lze ji spočítat pomocí <a class="reference external" href="https://en.wikipedia.org/wiki/Crout_matrix_decomposition">Croutova algoritmu</a>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
u_{ij} &amp;= a_{ij} - \sum_{k = 1}^{i - 1} l_{ik} u_{kj}, \quad i = 1, 2, \dots, j, \\
l_{ij} &amp;= \frac{1}{u_{jj}} \left( a_{ij} - \sum_{k = 1}^{j - 1} l_{ik} u_{kj} \right), \quad i = j + 1, j+2, \dots, n,
\end{align}
\end{split}\]</div>
<p>pro všechna <span class="math notranslate nohighlight">\(j = 1, 2, \dots, n\)</span>.</p>
<p>Tento algoritmus má podobnou složitost jako Gaussova eliminace. Je výhodný v případě, kdy řešíme stejnou soustavu rovnic pro mnoho různých pravých stran. V takovém případě by se nevyplatilo provádět Gaussovu eliminaci pořád znova. Naopak, pokud matici rozložíme pomocí LU dekompozice, stačí provést dvakrát zpětný běh Gaussovy eliminace, který je pouze <span class="math notranslate nohighlight">\(O(n^2)\)</span> oproti Gaussově eliminaci <span class="math notranslate nohighlight">\(O(n^3)\)</span>! Matematicky stačí vyřešit:</p>
<div class="math notranslate nohighlight">
\[
\mathbb{A} x = (\mathbb{L} \mathbb{U}) x = \mathbb{L} ( \mathbb{U} x) = b, 
\]</div>
<div class="math notranslate nohighlight">
\[
\mathbb{L} y = b, 
\]</div>
<div class="math notranslate nohighlight">
\[
\mathbb{U} x = y.
\]</div>
<section id="iterativniho-zpresneni-reseni">
<h4>Iterativního zpřesnění řešení<a class="headerlink" href="#iterativniho-zpresneni-reseni" title="Link to this heading">#</a></h4>
<p>Další výhodou je možnost rychlého <strong>iterativního zpřesnění řešení</strong>. Uvažujme nepřesné řešení <span class="math notranslate nohighlight">\(\vec{x}^{\prime}\)</span> soustavy <span class="math notranslate nohighlight">\(\mathbb{A} \vec{x} = \vec{b}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\vec{x}^{\prime} = \vec{x} + \delta \vec{x} \hspace{0.5em} \rightarrow \hspace{0.5em} \mathbb{A}(\vec{x} + \delta \vec{x}) = \vec{b} + \delta \vec{b} \hspace{0.5em} \rightarrow \hspace{0.5em} \mathbb{A} \delta\vec{x} = \delta{b} = \mathbb{A} \vec{x}^{\prime} - \vec{b}.
\]</div>
<p>Tedy počáteční nepřesné řešení <span class="math notranslate nohighlight">\(\vec{x}_0\)</span> můžeme nepřesné řešení iterativně zpřesňovat pomocí:</p>
<div class="math notranslate nohighlight">
\[
\vec{x}_{i+1} = \vec{x}_i + \delta \vec{x}_i, \quad \text{kde} \quad \mathbb{A} (\delta \vec{x}_i) = \vec{b} - \mathbb{A} \vec{x}_i.
\]</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #276BE9; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #DCE7FC; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Poznámka</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Pro velké matice (<span class="math notranslate nohighlight">\(N &gt; 50\)</span>) již dochází v <em>přímých metodách</em> k výraznému kumulování zaokrouhlovacích chyb, jelikož počet aritmetických operací roste s <span class="math notranslate nohighlight">\(O(N^3)\)</span>. Obzvlášť u matic blízkých <em>singulární matici</em> (lineární závislost řádků) je chyba významně zesilována. Proto je doporučeno využít iterativního zpřesnění, což umožní snížit chybu zpět na strojovou přesnost. Zároveň si tím nepokazíme celkovou složitost, jelikož prvotní řešení soustavy zabere <span class="math notranslate nohighlight">\(O(N^3)\)</span>, zatímco jedna iterace zpřesnění má složitost již jen <span class="math notranslate nohighlight">\(O(N^2)\)</span>!</p>
</p>
</div>
</div>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #276BE9; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #DCE7FC; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Poznámka</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p>Pro singulární matice nebo blízké singulární můžou přímé, které jsme v této kapitole viděli, snadno selhat. Existují proto specializované SVD metody (<em>Singular Value Decomposition</em>), které si dokáží poradit s obdélníkovými maticemi a maticemi se soustavami s závislými rovnicemi.</p>
</p>
</div>
</div></section>
</section>
</section>
<section id="zapoctova-uloha">
<h2>Zápočtová úloha<a class="headerlink" href="#zapoctova-uloha" title="Link to this heading">#</a></h2>
<div style="margin-top: 25px; margin-bottom: 25px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; border-radius: 4px; border-color: #E0B32C; border-right-width: 1px; border-top-width: 1px; border-bottom-width: 1px; border-left-width: 3px; border-style: solid">
<div style="background: #FFF3CD; color: #000000; padding-left: 20px; padding-top: 10px; padding-bottom: 10px; border-radius: 1px 3px 0px 0px; font-weight: 600">Úkol - zápočet 2</div>
<div style="padding-left: 20px; padding-right: 20px; padding-top: 0px; padding-bottom: 0px; border-radius: 0px 0px 3px 3px">
<p>
<p><a class="reference internal" href="../ukoly/03-linalg-prime-UKOL.html#ukol2"><span class="std std-ref">ZDE</span></a></p>
</p>
</div>
</div></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lekce"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../lekce-vyplnene/02-chyby-stabilita-vypl.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Numerické chyby a stabilita</p>
      </div>
    </a>
    <a class="right-next"
       href="04-linalg-iter.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Iterační metody lineární algebry</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#zakladni-operace-s-maticemi">Základní operace s maticemi</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skalarni-soucin">Skalární součin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#soucin-matice-s-vektorem">Součin matice s vektorem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#soucin-matice-s-matici">Součin matice s maticí</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reseni-soustavy-linearnich-rovnic">Řešení soustavy lineárních rovnic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prime-metody-pro-reseni-soustavy-linearnich-rovnic">Přímé metody pro řešení soustavy lineárních rovnic</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussova-eliminace">Gaussova eliminace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gauss-jordanova-eliminace">Gauss-Jordanova eliminace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thomasuv-algoritmus">Thomasův algoritmus</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lu-dekompozice">LU dekompozice</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#iterativniho-zpresneni-reseni">Iterativního zpřesnění řešení</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#zapoctova-uloha">Zápočtová úloha</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jiří Löffelmann
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>